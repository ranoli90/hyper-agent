<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HyperAgent</title>
    <link rel="stylesheet" href="./style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div id="app">
      <!-- Header -->
      <header id="header">
        <div id="tabs-nav">
          <button class="tab-btn active" data-tab="chat">Chat</button>
          <button class="tab-btn" data-tab="swarm">Swarm</button>
          <button class="tab-btn" data-tab="vision">Vision</button>
          <button class="tab-btn" data-tab="tasks">Tasks</button>
          <button class="tab-btn" data-tab="memory">Memory</button>
          <button class="tab-btn" data-tab="marketplace">Marketplace</button>
          <button class="tab-btn" data-tab="subscription">Subscription</button>
        </div>
        <div style="display:flex;align-items:center;gap:6px;">
          <button id="btn-dark-mode" title="Toggle dark mode" style="background:none;border:none;cursor:pointer;font-size:1rem;padding:4px;">üåô</button>
          <button id="btn-settings" title="Settings">‚öôÔ∏è</button>
          <span id="subscription-badge" class="subscription-badge free">Free</span>
        </div>
      </header>

      <main id="main-content">
        <!-- Chat Tab -->
        <section id="tab-chat" class="tab-pane active">
          <div id="chat-history"></div>
        </section>

        <!-- Swarm Tab -->
        <section id="tab-swarm" class="tab-pane">
          <div class="panel-inner">
            <h3>Swarm Intelligence</h3>
            <div id="swarm-status">
              <div class="swarm-indicator">
                <span class="swarm-dot"></span>
                <span id="swarm-state">Initializing...</span>
              </div>
            </div>
            <div id="swarm-agents">
              <div class="agent-list-header">
                <span>Active Agents</span>
                <span id="agent-count">8</span>
              </div>
              <div id="agent-list">
                <div class="agent-item">
                  <span class="agent-role">Intent Analyzer</span>
                  <span class="agent-status active">Ready</span>
                </div>
                <div class="agent-item">
                  <span class="agent-role">Information Gatherer</span>
                  <span class="agent-status active">Ready</span>
                </div>
                <div class="agent-item">
                  <span class="agent-role">Action Executor</span>
                  <span class="agent-status active">Ready</span>
                </div>
                <div class="agent-item">
                  <span class="agent-role">Validator</span>
                  <span class="agent-status active">Ready</span>
                </div>
                <div class="agent-item">
                  <span class="agent-role">Strategist</span>
                  <span class="agent-status active">Ready</span>
                </div>
                <div class="agent-item">
                  <span class="agent-role">Predictor</span>
                  <span class="agent-status active">Ready</span>
                </div>
                <div class="agent-item">
                  <span class="agent-role">Memory Manager</span>
                  <span class="agent-status active">Ready</span>
                </div>
                <div class="agent-item">
                  <span class="agent-role">Ethics Guardian</span>
                  <span class="agent-status active">Ready</span>
                </div>
              </div>
            </div>
            <div id="swarm-metrics">
              <h4>Mission Stats</h4>
              <div class="metrics-grid">
                <div class="metric-item">
                  <span class="metric-label">Missions Completed</span>
                  <span id="missions-completed" class="metric-value">0</span>
                </div>
                <div class="metric-item">
                  <span class="metric-label">Success Rate</span>
                  <span id="swarm-success-rate" class="metric-value">--</span>
                </div>
                <div class="metric-item">
                  <span class="metric-label">Active Missions</span>
                  <span id="active-missions" class="metric-value">0</span>
                </div>
                <div class="metric-item">
                  <span class="metric-label">Recovered Tasks</span>
                  <span id="recovered-tasks" class="metric-value">0</span>
                </div>
              </div>
            </div>
            <div id="mission-snapshots">
              <div class="snapshots-header">
                <h4>Saved Missions</h4>
                <button id="btn-clear-snapshots" class="btn-small">Clear All</button>
              </div>
              <div id="snapshots-list" class="empty-state">No saved missions.</div>
            </div>
          </div>
        </section>

        <!-- Vision Tab -->
        <section id="tab-vision" class="tab-pane">
          <div id="vision-container">
            <div id="vision-feed">
              <img id="vision-snapshot" class="hidden" alt="Snapshot" />
              <div id="vision-placeholder">No active vision feed.</div>
            </div>
            <div id="vision-overlays"></div>
          </div>
        </section>

        <!-- Tasks Tab -->
        <section id="tab-tasks" class="tab-pane">
          <div class="panel-inner">
            <div class="tasks-header">
              <h3>Active Tasks</h3>
              <button id="btn-add-task-ui">New</button>
            </div>

            <div class="guide-card">
              <div class="guide-step">
                <div class="step-num">1</div>
                <p>Enter a command</p>
              </div>
              <div class="guide-step">
                <div class="step-num">2</div>
                <p>Agent analyzes</p>
              </div>
              <div class="guide-step">
                <div class="step-num">3</div>
                <p>Agent executes</p>
              </div>
            </div>

            <div id="tasks-list" class="empty-state">No tasks running.</div>
          </div>
        </section>

        <!-- Memory Tab -->
        <section id="tab-memory" class="tab-pane">
          <div class="panel-inner">
            <h3>Memory</h3>
            <div id="memory-stats">0 sessions</div>
            <div id="memory-list"></div>
          </div>
        </section>

        <!-- Marketplace Tab -->
        <section id="tab-marketplace" class="tab-pane">
          <div class="panel-inner">
            <h3>Workflow Marketplace</h3>
            <p class="marketplace-subtitle">Discover and install powerful automation workflows</p>
            <div class="marketplace-search">
              <input id="marketplace-search-input" type="text" placeholder="Search workflows..." />
            </div>
            <div class="marketplace-categories" id="marketplace-categories">
              <button class="category-btn active" data-category="all">All</button>
              <button class="category-btn" data-category="data">Data</button>
              <button class="category-btn" data-category="communication">Communication</button>
              <button class="category-btn" data-category="marketing">Marketing</button>
              <button class="category-btn" data-category="business">Business</button>
              <button class="category-btn" data-category="productivity">Productivity</button>
            </div>
            <div id="marketplace-list" class="workflow-grid">
              <!-- Workflows loaded dynamically -->
            </div>
          </div>
        </section>

        <!-- Subscription Tab -->
        <section id="tab-subscription" class="tab-pane">
          <div class="panel-inner">
            <h3>Subscription &amp; Usage</h3>

            <!-- Current Plan Banner -->
            <div id="current-plan-banner" class="plan-banner free">
              <div class="plan-banner-info">
                <span class="plan-banner-tier" id="banner-tier">Free Plan</span>
                <span class="plan-banner-period" id="banner-period"></span>
              </div>
              <span class="plan-banner-badge" id="banner-badge">Active</span>
            </div>

            <!-- Usage Meters -->
            <div id="usage-display" class="usage-card">
              <h4>This Month's Usage</h4>
              <div class="usage-meter-group">
                <div class="usage-meter">
                  <div class="usage-meter-header">
                    <span class="label">Actions</span>
                    <span id="usage-actions" class="usage-count">0 / 100</span>
                  </div>
                  <div class="progress-track">
                    <div id="actions-progress" class="progress-bar-fill" style="width: 0%"></div>
                  </div>
                </div>
                <div class="usage-meter">
                  <div class="usage-meter-header">
                    <span class="label">Autonomous Sessions</span>
                    <span id="usage-sessions" class="usage-count">0 / 3</span>
                  </div>
                  <div class="progress-track">
                    <div id="sessions-progress" class="progress-bar-fill" style="width: 0%"></div>
                  </div>
                </div>
              </div>
              <div class="usage-footer">
                <span id="usage-tier" class="tier-label">Free</span>
                <span id="usage-reset">Resets in 30 days</span>
              </div>
            </div>

            <!-- License Key Input -->
            <div class="license-section">
              <h4>Have a License Key?</h4>
              <div class="license-input-row">
                <input id="license-key-input" type="text" placeholder="HA-PREMIUM-XXXXXXXX-XXXXXXXX" />
                <button id="btn-activate-license">Activate</button>
              </div>
              <div id="license-status" class="license-status hidden"></div>
            </div>

            <!-- Billing Interval Toggle -->
            <div class="billing-toggle">
              <button class="interval-btn active" data-interval="month">Monthly</button>
              <button class="interval-btn" data-interval="year">Yearly <span class="save-badge">Save 17%</span></button>
            </div>

            <!-- Plan Cards -->
            <div class="subscription-options">
              <div class="plan-card" data-plan="free">
                <h4>Free</h4>
                <div class="plan-price"><span class="price-amount">$0</span><span class="price-period">/month</span></div>
                <ul>
                  <li>100 actions/month</li>
                  <li>3 autonomous sessions</li>
                  <li>Basic automation</li>
                  <li>Community support</li>
                </ul>
                <button id="btn-plan-free" class="plan-btn current" disabled>Current Plan</button>
              </div>
              <div class="plan-card popular" data-plan="premium">
                <div class="popular-badge">Most Popular</div>
                <h4>Premium</h4>
                <div class="plan-price">
                  <span class="price-amount" id="premium-price">$19</span>
                  <span class="price-period" id="premium-period">/month</span>
                </div>
                <ul>
                  <li>1,000 actions/month</li>
                  <li>50 autonomous sessions</li>
                  <li>Advanced workflows &amp; macros</li>
                  <li>Vision mode</li>
                  <li>Swarm intelligence</li>
                  <li>Priority support</li>
                </ul>
                <button id="btn-upgrade-premium" class="plan-btn upgrade">Upgrade to Premium</button>
              </div>
              <div class="plan-card" data-plan="unlimited">
                <h4>Unlimited</h4>
                <div class="plan-price">
                  <span class="price-amount" id="unlimited-price">$49</span>
                  <span class="price-period" id="unlimited-period">/month</span>
                </div>
                <ul>
                  <li>Unlimited actions</li>
                  <li>Unlimited sessions</li>
                  <li>All Premium features</li>
                  <li>API access</li>
                  <li>Team collaboration</li>
                  <li>Custom workflows</li>
                  <li>Dedicated support</li>
                </ul>
                <button id="btn-upgrade-unlimited" class="plan-btn upgrade">Upgrade to Unlimited</button>
              </div>
            </div>

            <div class="subscription-footer">
              <p>Payments processed securely by Stripe. Cancel anytime.</p>
              <button id="btn-cancel-subscription" class="btn-link hidden">Cancel Subscription</button>
            </div>
          </div>
        </section>
      </main>

      <!-- Status Bar -->
      <div id="status-bar" class="hidden">
        <div class="stepper">
          <div class="step" data-step="observe">Obs</div>
          <div class="step-line"></div>
          <div class="step" data-step="plan">Plan</div>
          <div class="step-line"></div>
          <div class="step" data-step="act">Act</div>
          <div class="step-line"></div>
          <div class="step" data-step="verify">Ver</div>
        </div>
        <span id="status-text">Ready</span>
      </div>

      <!-- Input Area -->
      <div id="input-area">
        <div id="suggestions-container" class="hidden"></div>
        <div class="input-wrapper">
          <textarea id="command-input" rows="1" placeholder="Type a command..."></textarea>
          <div id="char-counter" aria-live="polite">0 / 2000</div>
        </div>
        <div class="input-actions">
          <button id="btn-mic" title="Voice Input">üé§</button>
          <button id="btn-stop" class="hidden">Stop</button>
          <button id="btn-execute">Run</button>
        </div>
      </div>

      <!-- Modals -->
      <div id="confirm-modal" class="modal hidden">
        <div class="modal-content">
          <h3 id="confirm-title">Confirm</h3>
          <p id="confirm-summary"></p>
          <ul id="confirm-actions-list"></ul>
          <div class="modal-actions">
            <button id="btn-cancel">Cancel</button>
            <button id="btn-confirm">Confirm</button>
          </div>
        </div>
      </div>

      <div id="ask-modal" class="modal hidden">
        <div class="modal-content">
          <h3 id="ask-title">Question</h3>
          <p id="ask-question"></p>
          <textarea id="ask-reply" placeholder="Reply..."></textarea>
          <div class="modal-actions">
            <button id="btn-ask-cancel">Cancel</button>
            <button id="btn-ask-reply">Reply</button>
          </div>
        </div>
      </div>
    </div>
    <div id="loading-overlay" class="loading-overlay hidden">
      <div class="loading-content">
        <div class="spinner"></div>
        <div class="loading-text">Processing...</div>
        <div class="progress-bar">
          <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
        </div>
        <div id="progress-percent" class="progress-percent">0%</div>
      </div>
    </div>
    <div id="toast-container" class="toast-container" aria-live="polite"></div>

    <script type="module" src="./main.ts"></script>
  </body>
</html>
